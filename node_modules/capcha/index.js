var $$Http = require('http');
var $$qs = require('querystring');
var $$Promise = require('bluebird');

var options = {  
    hostname: 'images.wan451.com',  
    port: 80,  
    path: '/capcha.do',  
    method: 'GET'  
};  

var getCapcho = function(callback){
	var req = $$Http.request(options, function (res) {  
	    res.setEncoding('utf8');  
	    res.on('data', function (chunk) {  
	    	var data = JSON.parse(chunk)      
	    	callback(null,data);
	    });  
	});  
	  
	req.on('error', function (e) {  
	    callback(e,null);
	});  
	  
	req.end();  
};

module.exports = $$Promise.promisify(getCapcho);